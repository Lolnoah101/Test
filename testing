local Luna = loadstring(game:HttpGet("https://raw.nebulasoftworks.xyz/luna", true))()

local Window = Luna:CreateWindow({
    Name = "Luna Example Window", -- This Is Title Of Your Window
    Subtitle = nil, -- A Gray Subtitle next To the main title.
    LogoID = "82795327169782", -- The Asset ID of your logo. Set to nil if you do not have a logo for Luna to use.
    LoadingEnabled = true, -- Whether to enable the loading animation. Set to false if you do not want the loading screen or have your own custom one.
    LoadingTitle = "Luna Interface Suite", -- Header for loading screen
    LoadingSubtitle = "by Nebula Softworks", -- Subtitle for loading screen

    ConfigSettings = {
        RootFolder = nil, -- The Root Folder Is Only If You Have A Hub With Multiple Game Scripts and u may remove it. DO NOT ADD A SLASH
        ConfigFolder = "Big Hub" -- The Name Of The Folder Where Luna Will Store Configs For This Script. DO NOT ADD A SLASH
    },

    KeySystem = false, -- As Of Beta 6, Luna Has officially Implemented A Key System!
    KeySettings = {
        Title = "Luna Example Key",
        Subtitle = "Key System",
        Note = "Best Key System Ever! Also, Please Use A HWID Keysystem like Pelican, Luarmor etc. that provide key strings based on your HWID since putting a simple string is very easy to bypass",
        SaveInRoot = false, -- Enabling will save the key in your RootFolder (YOU MUST HAVE ONE BEFORE ENABLING THIS OPTION)
        SaveKey = true, -- The user's key will be saved, but if you change the key, they will be unable to use your script
        Key = {"Example Key"}, -- List of keys that will be accepted by the system, please use a system like Pelican or Luarmor that provide key strings based on your HWID since putting a simple string is very easy to bypass
        SecondAction = {
            Enabled = true, -- Set to false if you do not want a second action,
            Type = "Link", -- Link / Discord.
            Parameter = "" -- If Type is Discord, then put your invite link (DO NOT PUT DISCORD.GG/). Else, put the full link of your key system here.
        }
    }
})

local Tab = Window:CreateTab({
    Name = "Tab Example",
    Icon = "view_in_ar",
    ImageSource = "Material",
    ShowTitle = true -- This will determine whether the big header text in the tab will show
})

local autoClickEnabled = false 

Tab:CreateToggle({
   Name = "Toggle Example",
    Description = nil,
    CurrentValue = false,
    Callback = function(Value)
      autoClickEnabled = Value
      
      if Value then
         task.spawn(function()
            while autoClickEnabled do
               pcall(function()
                  game:GetService("ReplicatedStorage"):WaitForChild("Packages"):WaitForChild("_Index"):WaitForChild("sleitnick_knit@1.5.1"):WaitForChild("knit"):WaitForChild("Services"):WaitForChild("ClickService"):WaitForChild("RF"):WaitForChild("Click"):InvokeServer()
               end)
               task.wait()   -- very fast – use task.wait(0.05) if too aggressive
            end
         end)
      end
   end,
})

-- ────────────────────────────────────────────────────────────────
-- Enemy Teleport Dropdown + Refresh (NO HumanoidRootPart REQUIRED)
-- ────────────────────────────────────────────────────────────────

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

local enemyDropdown = nil
local currentEnemyNames = {}

-- Helper: Get current list of enemy names
local function getEnemyNames()
    local folder = workspace:FindFirstChild("MobSpawns")
    if not folder then return {} end
    
    local nomekFolder = folder:FindFirstChild("Nomek")
    if not nomekFolder then return {} end
    
    local names = {}
    for _, obj in ipairs(nomekFolder:GetChildren()) do
        if obj:IsA("Model") then
            -- Include any model (even without Humanoid)
            table.insert(names, obj.Name)
        end
    end
    
    table.sort(names)  -- alphabetical
    return names
end

-- Helper: Find a good CFrame reference in the model (no HRP needed)
local function getModelCFrameReference(model)
    if not model or not model:IsA("Model") then return nil end
    
    -- Priority 1: HumanoidRootPart (if exists)
    local hrp = model:FindFirstChild("HumanoidRootPart")
    if hrp and hrp:IsA("BasePart") then
        return hrp.CFrame
    end
    
    -- Priority 2: PrimaryPart (if model has one set)
    if model.PrimaryPart and model.PrimaryPart:IsA("BasePart") then
        return model.PrimaryPart.CFrame
    end
    
    -- Priority 3: Find any BasePart (e.g., main body/head/torso)
    for _, part in ipairs(model:GetDescendants()) do
        if part:IsA("BasePart") then
            return part.CFrame
        end
    end
    
    -- Fallback: model pivot if nothing else
    return model:GetPivot()
end

-- Refresh / (re)create dropdown
local function refreshEnemyDropdown()
    currentEnemyNames = getEnemyNames()
    
    if enemyDropdown then
        pcall(function()
            enemyDropdown:SetOptions(currentEnemyNames)
        end)
    end
    
    if not enemyDropdown then
        enemyDropdown = Tab:CreateDropdown({
            Name = "Teleport to Enemy",
            Description = "Select an enemy → teleports to it (refresh if list outdated)",
            Options = currentEnemyNames,
            CurrentOption = {},
            MultipleOptions = false,
            Flag = "EnemyTeleportDropdown",
            Callback = function(selected)
                if typeof(selected) == "table" then selected = selected[1] end
                if not selected or selected == "" then return end
                
                local nomek = workspace.MobSpawns:FindFirstChild("Nomek")
                if not nomek then warn("Nomek folder missing") return end
                
                local targetModel = nomek:FindFirstChild(selected)
                if not targetModel then warn("Enemy not found: " .. selected) return end
                
                local targetCFrame = getModelCFrameReference(targetModel)
                if not targetCFrame then warn("No valid CFrame/part in " .. selected) return end
                
                local character = LocalPlayer.Character
                if not character then return end
                
                local playerHrp = character:FindFirstChild("HumanoidRootPart")
                if not playerHrp then return end
                
                -- Teleport slightly above the target (avoids clipping inside)
                playerHrp.CFrame = targetCFrame * CFrame.new(0, 6, 0)
            end
        })
    end
end

-- Refresh button
Tab:CreateButton({
    Name = "Refresh Enemy List",
    Description = "Update dropdown with current mobs in Nomek",
    Callback = refreshEnemyDropdown
})

-- Initial refresh
refreshEnemyDropdown()

local Luna = loadstring(game:HttpGet("https://raw.nebulasoftworks.xyz/luna", true))()

local Window = Luna:CreateWindow({
    Name = "Luna Example Window", -- This Is Title Of Your Window
    Subtitle = nil, -- A Gray Subtitle next To the main title.
    LogoID = "82795327169782", -- The Asset ID of your logo. Set to nil if you do not have a logo for Luna to use.
    LoadingEnabled = true, -- Whether to enable the loading animation. Set to false if you do not want the loading screen or have your own custom one.
    LoadingTitle = "Luna Interface Suite", -- Header for loading screen
    LoadingSubtitle = "by Nebula Softworks", -- Subtitle for loading screen

    ConfigSettings = {
        RootFolder = nil, -- The Root Folder Is Only If You Have A Hub With Multiple Game Scripts and u may remove it. DO NOT ADD A SLASH
        ConfigFolder = "Big Hub" -- The Name Of The Folder Where Luna Will Store Configs For This Script. DO NOT ADD A SLASH
    },

    KeySystem = false, -- As Of Beta 6, Luna Has officially Implemented A Key System!
    KeySettings = {
        Title = "Luna Example Key",
        Subtitle = "Key System",
        Note = "Best Key System Ever! Also, Please Use A HWID Keysystem like Pelican, Luarmor etc. that provide key strings based on your HWID since putting a simple string is very easy to bypass",
        SaveInRoot = false, -- Enabling will save the key in your RootFolder (YOU MUST HAVE ONE BEFORE ENABLING THIS OPTION)
        SaveKey = true, -- The user's key will be saved, but if you change the key, they will be unable to use your script
        Key = {"Example Key"}, -- List of keys that will be accepted by the system, please use a system like Pelican or Luarmor that provide key strings based on your HWID since putting a simple string is very easy to bypass
        SecondAction = {
            Enabled = true, -- Set to false if you do not want a second action,
            Type = "Link", -- Link / Discord.
            Parameter = "" -- If Type is Discord, then put your invite link (DO NOT PUT DISCORD.GG/). Else, put the full link of your key system here.
        }
    }
})

local Tab = Window:CreateTab({
    Name = "Tab Example",
    Icon = "view_in_ar",
    ImageSource = "Material",
    ShowTitle = true -- This will determine whether the big header text in the tab will show
})

local CollectLeavesEnabled = false

Tab:CreateToggle({
   Name = "Toggle Example",
    Description = nil,
    CurrentValue = false,
    Callback = function(Value)
      CollectLeavesEnabled = Value   -- Updated variable name
      
      if Value then
         task.spawn(function()
            while CollectLeavesEnabled do
               pcall(function()
                  -- ✅ NEW PATH: workspace.CoinContainer (leafs inside)
                  local coinContainer = workspace:WaitForChild("CoinContainer")
                  if not coinContainer then return end
                  
                  local remotes = game:GetService("ReplicatedStorage"):WaitForChild("Remotes")
                  local collectRemote = remotes:FindFirstChild("CollectPart")
                  if not collectRemote then return end
                  
                  -- Collect all current leaves/coins
                  for _, leaf in ipairs(coinContainer:GetChildren()) do
                     if not CollectLeavesEnabled then return end  -- early exit if toggled off
                     
                     local leafName = leaf.Name
                     if leafName and #leafName > 0 and leaf.Parent then  -- Extra safety: check exists
                        pcall(function()  -- pcall per fire (safer)
                           collectRemote:FireServer(leafName)
                        end)
                        task.wait(0.03)  -- Tiny delay between fires (tune: 0.01–0.1)
                     end
                  end
               end)
               
               -- Wait for new leaves to spawn
               task.wait(0.5)  -- Tune: 0.2–2 seconds based on spawn rate
            end
         end)
      end
   end,
})
